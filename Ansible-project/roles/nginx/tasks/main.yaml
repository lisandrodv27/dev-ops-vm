- name: "Install NGINX"
  apt:
    name: nginx
    state: latest
    update_cache: "yes"
- name: "Start NGINX"
  service:
    name: nginx
    state: started
- name: "Update packages"
  apt:
    update_cache: "yes"
    force_apt_get: "yes"
- name: "Install nginx.conf file in Jenkins VM"
  template:
    src: ./nginx.conf
    dest: /etc/nginx/nginx.conf
  register: nginx_config
- name: "Reload NGINX"
  service:
    name: nginx
    state: reloaded
  when: nginx_config.changed